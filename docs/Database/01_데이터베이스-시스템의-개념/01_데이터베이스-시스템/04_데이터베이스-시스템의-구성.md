# 데이터베이스 시스템의 구성
<br/>

데이터베이스 시스템(Database System)은 데이터베이스(database), 데이터베이스 관리 시스템(DBMS), 데이터 모델(data model)의 세 가지로 구성된다.
데이터베이스는 하드디스크에 저장된 데이터이고, DBMS는 주기억장치에 저장된 소프트웨어를 말한다.
데이터 모델은 눈에 보이지 않는 논리적인 개념으로 데이터가 저장되는 기법에 관한 내용이다.
이외에도 데이터베이스 시스템을 이해하기 위해서는 데이터베이스 언어, 데이터베이스 사용자에 대해 알아야 한다.

#### [데이터베이스 시스템의 구성]
<img src="https://github.com/silxbro/cs-study/assets/142463332/6b79a963-ceb5-4c30-be8a-b8038abc58f7" width="550" height="430"/><br/>
<br/>
<br/>
## 1. 데이터베이스 언어
데이터베이스 시스템은 데이터베이스 전용 언어인 SQL(Structured Query Language)을 사용한다.
SQL은 데이터 정의어(DDL, Data Definition Language), 데이터 조작어(DML, Data Manipulation Language), 데이터 제어어(DCL, Data Control Language)로 구성된다.
데이터 정의어는 CREATE, ALTER, DROP 문과 같이 DBMS에 저장된 테이블 구조를 정의하고, 데이터 조작어는 SELECT, INSERT, DELETE, UPDATE 문과 같이 데이터를
검색, 삽입, 삭제, 수정하는 데 사용하는 언어이다. 데이터 제어어는 GRANT, REVOKE 문과 같이 데이터의 사용 권한을 관리한다.

SQL의 핵심은 데이터 조작어 중 데이터를 검색하는 질의(query)문이다. 질의문은 SELECT-FROM-WHERE 구조로 되어 있다. 다음 Book 테이블에서 질의문의 사용 예를 살펴보자.

#### Book
|bookid|bookname|publisher|price|
|:---|:---|:---|:---|
|1|축구의 역사|굿스포츠|7000|
|2|축구아는 여자|나무수|13000|
|3|축구의 이해|대한미디어|22000|
|4|골프 바이블|대한미디어|35000|
|5|피겨 교본|굿스포츠|8000|

#### [질의 1-1] Book 테이블에서 모든 도서이름(bookname)과 출판사(publisher)를 검색하시오.
```SQL
SELECT  bookname, publisher
FROM    Book;
```
[질의 1-1]의 SQL 문 호출 결과는 다음과 같다. Book 테이블에서 모든 도서의 bookname과 publisher 값을 보여준다.<br/>
|bookname|publisher|
|:---|:---|
|축구의 역사|굿스포츠|
|축구아는 여자|나무수|
|축구의 이해|대한미디어|
|골프 바이블|대한미디어|
|피겨 교본|굿스포츠|

#### [질의 1-2] 가격(price)이 10,000원 이상인 도서이름(bookname)과 출판사(publisher)를 검색하시오.
```SQL
SELECT  bookname, publisher
FROM    Book
WEHRE   price >= 10000;
```
[질의 1-2]의 SQL 문 호출 결과는 다음과 같다. Book 테이블에서 가격이 10,000원 이상인 도서의 bookname과 publisher 값을 보여준다.
|bookname|publisher|
|:---|:---|
|축구아는 여자|나무수|
|축구의 이해|대한미디어|
|축구의 이해|대한미디어|
<br/>

## 2. 데이터베이스 사용자
데이터베이스 시스템을 사용하는 사람은 크게 일반 사용자, 응용 프로그래머, SQL 사용자, 데이터베이스 관리자로 구분할 수 있다.
여기서 응용 프로그래머는 데이터베이스를 이용하여 문제를 해결하는 프로그램을 작성하는 사람이고, 일반 사용자는 응용 프로그래머가 작성한 프로그램을 이용하는 사람이다.
또 SQL 사용자는 SQL 질의를 작성하거나 SQL을 이용하여 프로그램을 작성하는 사람이다.
데이터베이스 관리자는 DBA(Database Administrator)라고도 하는데, 조직의 데이터베이스 운영을 총괄하는 사람이다.

### 🔳 일반 사용자
은행의 창구 혹은 관공서의 민원 접수처 등에서 데이터를 다루는 업무를 하는 사람이다. 일반 사용자(end user)는 프로그래머가 개발한 프로그램을 이용하여 데이터베이스에 접근한다.
보통 특별한 지식 없이 데이터베이스에 접근하여 데이터의 검색, 삽입, 삭제, 수정 작업을 한다. 따라서 일반 사용자는 자신이 DBMS를 이용하는지 알지 못한다.

### 🔳 응용 프로그래머
일반 사용자가 사용할 수 있도록 프로그램을 만드는 사람이다.
응용 프로그래머(application programmer)는 자바, C, JSP 등의 프로그래밍 언어와 SQL을 사용하여 일반 사용자를 위한 사용자 인터페이스와 데이터를 관리하는 응용 로직을 개발한다.
특별히 데이터베이스 프로그래머라고 말하기도 한다.

### 🔳 SQL 사용자
SQL을 사용하여 업무를 처리하는 IT 부서의 담당자로, 응용 프로그램으로 구현되어 있지 않은 업무를 SQL을 사용하여 처리한다.
주로 데이터 검색, 데이터 구조 변경, 데이터에 관한 통계 처리 등 데이터를 모니터링하는 업무를 하거나 보고서 형태로 만들어 상부에 보고하는 업무를 한다.

### 🔳 데이터베이스 관리자(DBA, Database Administrator)
데이터베이스 운영 조직의 데이터베이스 시스템을 총괄하는 사람이다. 보통 데이터베이스마다 한 명을 두며 큰 조직의 경우 여러 명을 두기도 한다.
DBA는 데이터 설계, 구현, 유지보수의 전 과정을 담당한다. 또한 데이터베이스 사용자 통제, 보안, 성능 모니터링, 데이터 전체 파악 및 관리, 데이터 이동 및 복사 등 제반 업무를 맡는다.
<br/>
<br/>
<br/>
데이터베이스 사용자별로 갖추어야 할 지식 수준을 정리하면 다음 표와 같다.
응용 프로그래머는 보통 데이터베이스 프로그래머라고 하며 프로그래밍 능력, DBMS 지식, 데이터 구성에 대한 지식 등을 갖추어야 한다.
데이터베이스 관리자는 프로그래밍 능력 외에도 특별히 DBMS 지식 및 데이터 구성에 관한 지식이 많이 필요하다.

#### [데이터베이스 사용자별로 갖추어야 할 지식 수준] (x: 없음, ○: 보통, ◎: 높음)
|사용자/필요한 지식|SQL 언어|프로그래밍 능력|DBMS 지식|데이터 구성|
|:---|:---|:---|:---|:---|
|**일반 사용자**|x|x|x|x|
|**SQL 사용자**|◎|x|○|○|
|**응용 프로그래머**|◎|◎|○|○|
|**데이터베이스 관리자**|◎|○|◎|◎|
<br/>

## 3. DBMS
DBMS는 사용자와 데이터베이스를 연결시켜주는 소프트웨어로, 데이터베이스 사용자가 데이터베이스를 생성, 공유, 관리할 수 있도록 지원해주는 총체적인 역할을 한다.
주기억장치에 저장된 DBMS는 SQL을 번역하는 DML/DDL 컴파일러와 응용 프로그램에 삽입(embedded)된 SQL을 번역하는 Embedded DML 컴파일러로 구성되어 있으며,
번역된 SQL을 처리하는 알고리즘인 질의처리기가 있다. 이 밖에도 트랜잭션을 관리하는 트랜잭션 관리자, 파일을 관리하는 파일 관리자, 버퍼 관리자 등이 있다.
하드디스크에 저장된 데이터베이스는 데이터 파일을 포함하여 데이터에 빠르게 접근하기 위한 인덱스, 데이터에 대한 정보를 저장하는 데이터 사전 등을 저장하고 있다.
DBMS는 이들 데이터에 접근하여 사용자의 질의를 처리한다.
- 트랜잭션은 데이터베이스를 처리하는 프로그램의 단위를 말한다.

DBMS는 1960년대 초부터 제품이 생산되기 시작하였으며, 1970년대에 등장한 SQL 기반의 관계 데이터 모델이 현재 가장 많이 사용된다.
관계 데이터 모델은 데이터들의 관계를 테이블 형태로 표현하여 사용자가 데이터에 접근하기 쉽게 한다.
DBMS가 데이터베이스 사용자와의 상호작용을 통해 수행하는 기능을 정리하면 다음과 같다.

#### [DBMS의 기능]
|기능|설명|
|:---|:---|
|데이터 정의(Definition)|- 데이터의 구조를 정의하고 데이터 구조에 대한 삭제 및 변경 기능을 수행|
|데이터 조작(Manipulation)|- 데이터를 조작하는 소프트웨어(응용 프로그램)가 요청하는 데이터의<br/>&nbsp;&nbsp;&nbsp;검색, 삽입, 수정, 삭제 작업을 지원|
|데이터 추출(Retrieval)|- 사용자가 조회하는 데이터 혹은 응용 프로그램의 데이터를 추출|
|데이터 제어(Control)|- 데이터베이스 사용자를 생성하고 모니터링하며 접근을 제어<br/>- 백업과 회복, 동시성 제어 등의 기능을 지원|
<br/>

## 4. 데이터 모델
데이터 모델은 데이터베이스 시스템에서 데이터를 저장하는 이론적인 방법에 관한 것으로, 데이터베이스에 데이터가 어떻게 구조화되어 저장되는지를 결정한다.
가장 많이 사용되는 데이터 모델은 관계 데이터 모델(relational data model)이다.

기존에 사용되었던 데이터 모델로는 계층 데이터 모델(hierarchical data model), 네트워크 데이터 모델(network data model), 객체 데이터 모델(object data model),
객체-관계 데이터 모델(object-relational data model) 등이 있다.
객체-관계 데이터 모델은 객체지향 언어가 널리 사용됨에 따라 관계 데이터 모델과 객체 데이터 모델의 장점을 결합한 모델이다.

데이터 모델을 구분하는 가장 큰 기준은 데이터들 간에 관계를 표현하는 방법이다. 예를 들어 학생 정보를 저장하는 테이블과 강좌 정보를 저장하는 테이블이 있을 경우,
박지성 학생이 자료구조를, 김연아 학생이 데이터베이스를 수강한다는 학생-강좌 관계(relationship)를 표현해야 한다고 가정해보자.
이를 표현하는 방법은 다음과 같이 세 가지가 있다.

#### [관계 표현을 위한 예시]
<img src="https://github.com/silxbro/cs-study/assets/142463332/3be84765-3f07-42df-afd4-d3aedd6539e8" width="550" height="160"/><br/>

### (1) 포인터 사용 : 계층 데이터 모델, 네트워크 데이터 모델
프로그래밍 언어의 포인터 타입을 이용하여 강좌 데이터 y가 저장된 포인터 값 p를 학생 데이터 x에 저장하는 방법으로, 계층 데이터 모델과 네트워크 데이터 모델에서 사용한다.
포인터를 사용하는 방법은 데이터를 직접 찾아갈 수 있어서 프로그램 속도는 빠르지만 포인터를 다루는 프로그래밍을 해야 하기 때문에 응용 프로그램 개발 속도 면에서
느리다는 단점이 있다.

#### [포인터를 사용하여 관계 표현]
<img src="https://github.com/silxbro/cs-study/assets/142463332/63e1fd1a-af44-4bbc-97da-67fb54a0852f" width="550" height="160"/><br/>

### (2) 속성 값 사용 : 관계 데이터 모델
강좌 데이터 y의 속성인 강좌번호 값 v를 학생 데이터 x에 직접 저장하는 방법으로, 데이터를 찾을 때는 강좌번호 값을 이용하여 어떤 강좌를 신청했는지 알아낸다.
포인터를 사용하는 방법보다 속도는 조금 느리지만 개념이 쉽고 프로그램 개발이 빠르기 때문에 관계 데이터 모델을 비롯한 많은 데이터베이스 시스템에서 이 방법을 사용한다.
다음 그림에서 보듯이 직접적인 포인터는 없고 값을 이용하여 관계를 찾아간다.

#### [속성 값을 사용하여 관계 표현]
<img src="https://github.com/silxbro/cs-study/assets/142463332/e3076449-6c7b-4749-b99c-7eb9b03c6002" width="550" height="160"/><br/>

### (3) 객체식별자 사용 : 객체 데이터 모델
강좌를 객체 개념으로 보고 강좌 객체의 고유 식별자인 오브젝트 아이디(oid)를 학생 테이블에 저장하는 방법이다.
객체 데이터 모델에서 사용하며 객체지향 언어의 상속, 캡슐화 등의 개념을 도입한다.

#### [객체식별자를 사용하여 관계 표현]
<img src="https://github.com/silxbro/cs-study/assets/142463332/ff5e7263-b371-482b-8814-6a384cfe9660" width="550" height="160"/><br/>

현재 데이터베이스 시스템은 관계 데이터 모델을 기본 개념으로 하고 객체 데이터 모델의 장점을 일부 수용한 객체-관계 데이터 모델로 발전하고 있다.
데이터 모델에서 관계 표현 방법을 요약하면 다음과 같다.

#### [데이터 모델과 각 모델에서 관계의 표현 방법]
|데이터 모델|관계의 표현|데이터 구성|
|:---|:---|:---|
|계층 데이터 모델<br/>(포인터 사용)|<img src="https://github.com/silxbro/cs-study/assets/142463332/d934bd68-ced6-4098-ad5f-25d98eb81107" width="150" height="150"/>|<img src="https://github.com/silxbro/cs-study/assets/142463332/86069dfe-bca1-4a3d-92af-6dac2bd3978d" width="300" height="150"/>|
|네트워크 데이터 모델<br/>(포인터 사용)|<img src="https://github.com/silxbro/cs-study/assets/142463332/d934bd68-ced6-4098-ad5f-25d98eb81107" width="150" height="150"/>|<img src="https://github.com/silxbro/cs-study/assets/142463332/37669a09-b991-4920-9695-73425de0c859" width="300" height="150"/>|
|관계 데이터 모델<br/>(속성 값 사용)|<img src="https://github.com/silxbro/cs-study/assets/142463332/a07d1fbd-4a13-4528-95e9-e71c7dca285e" width="150" height="150"/>|<img src="https://github.com/silxbro/cs-study/assets/142463332/e99b6592-7de8-4ff3-9203-8374fd24ce9c" width="300" height="150"/>|
|객체 데이터 모델<br/>(객체식별자 사용)|<img src="https://github.com/silxbro/cs-study/assets/142463332/73267444-7283-4003-807c-5e74bff8c9b6" width="150" height="150"/>|<img src="https://github.com/silxbro/cs-study/assets/142463332/6aa0dd3f-9fc5-4e53-a24d-563d99ed001c" width="300" height="150"/>|

데이터 모델을 사용 시기별로 보면 다음 표와 같다.
계층 데이터 모델 제품은 1960년대 IBM사의 IMS가 있고, 네트워크 데이터 모델 제품은 1960년대 중반에 General Electric사의 IDS가 있다.
이후 1970년 E. F. Codd 박사가 관계 데이터 모델을 제안한 논문을 발표한 후 IBM사에서 SQL을 사용하는 System R(DB2의 전신), 오라클사에서 Oracle 관계 데이터베이스 제품을 출시하였다.

그 후 데스크탑용으로 dBASE가 출시되었고, MySQL사(Oracle사에 합병되었음)의 MySQL, 마이크로소프트사의 SQL Server, Informix사(IBM사에 합병되었음)의 Informix 제품이 출시되었다.
또 관계 데이터베이스가 갖는 텍스트 위주의 한계를 극복하기 위하여 객체 개념에 기반한 GemStone, ObjectStore 등의 객체 데이터 모델 제품이 출시되었다.

#### [데이터 모델의 역사]
|데이터 모델/제품 종류|1960년대|1970년대|1980년대|1990년대|2000년대|2010년대|
|:---|:---:|:---:|:---:|:---:|:---:|:---:|
|**계층 데이터 모델**<br/>(ex) IMS|⇒|⇒|⇒||||
|**네트워크 데이터 모델**<br/>(ex) IDS|⇒|⇒|⇒||||
|**관계 데이터 모델**<br/>(ex) Oracle, SQL Server, MySQL|||⇒|⇒|⇒|⇒|
|**객체 데이터 모델**<br/>(ex) GemStone, ObjectStore||||⇒|⇒||
|**객체-관계 데이터 모델**<br/>(ex) UniSQL|||||⇒|⇒|
<br/>

## 5. 데이터베이스의 개념적 구조
1975년 ANSI(American National Standards Institute)에서는 데이터베이스를 개념적으로 이해하기 위해 데이터베이스 구조에 관한 안을 만들었다.
이 안은 데이터베이스를 보는 관점(view)을 세 개의 단계로 분리한 것으로, 3단계 데이터베이스 구조(3-layer database architecture)라고 부른다.
3단계 데이터베이스 구조는 데이터베이스의 복잡한 구조를 단순화하여 표현한다.

### 3단계 데이터베이스 구조
3단계 데이터베이스 구조는 다음 그림과 같이 외부 단계, 개념 단계, 내부 단계로 나누어진다.
각 단계를 설명하는 데 사용되는 용어 '스키마(schema)'는 그리스어에서 유래된 단어로 조직이나 구조를 의미한다.

#### [ANSI의 3단계 데이터베이스 구조]
<img src="https://github.com/silxbro/cs-study/assets/142463332/cfae5e80-33d1-43a7-9284-bd6588691661" width="600" height="300"/><br/>

### (1) 외부 단계
일반 사용자나 응용 프로그래머가 접근하는 계층으로 전체 데이터베이스 중에서 하나의 논리적인 부분을 의미한다. 여러 개의 외부 스키마(external schema)가 있을 수 있다.
외부 스키마는 서브 스키마(sub schema)라고도 하며, 뷰(view)의 개념이다.
대학 데이터베이스를 예로 들면 학성처의 학생 정보, 교무처의 수강 정보 등은 전체 데이터베이스의 일부분으로 각 부서의 사용자들에게만 필요한 각각의 스키마라고 할 수 있다.

### (2) 개념 단계
전체 데이터베이스의 정의를 의미한다. 통합 조직별로 하나만 존재하며 DBA가 관리한다. 즉 하나의 데이터베이스에는 하나의 개념 스키마(conceptual schema)가 있다.
개념 스키마는 저장장치에 독립적으로 기술되며, 데이터와 관계(relationship), 제약사항, 무결성에 대한 내용이 포함된다.
대학 데이터베이스를 예로 들면 학생 정보, 수강 정보 등이 모두 모인 대학 전체 데이터베이스를 뜻한다.

### (3) 내부 단계
물리적 저장장치에 데이터베이스가 실제로 저장되는 방법을 표현한다.
내부 스키마(internal schema)는 하나이며, 인덱스, 데이터 레코드의 배치 방법, 데이터 압축 등에 관한 사항이 포함된다.
대학 데이터베이스를 예로 들면 대학 전체 데이터베이스가 실제 하드디스크에 저장되는 물리적인 구조를 뜻한다. 여기서는 저장 방법에 대한 구체적인 내용이 포함된다.
<br/>
<br/>
<br/>
DBMS는 `매핑(mapping)(사상)`을 통하여 각 단계 간 대응 관계를 정의한다.
매핑은 개념 스키마의 어느 부분이 외부 스키마가 되는지 또는 개념 스키마가 어떤 물리적인 표현을 통하여 내부 스키마가 되는지에 따라 두 가지로 나뉜다.

- **외부/개념 매핑**
    - 사용자의 외부 스키마와 개념 스키마 간의 매핑(사상)으로 외부 스키마의 데이터가 개념 스키마의 어느 부분에 해당되는지 대응시킨다.
- **개념/내부 매핑**
    - 개념 스키마의 데이터가 내부 스키마의 물리적 장치 어디에 어떤 방법으로 저장되는지 대응시킨다.

### [데이터베이스 구조의 예] : 수강신청 데이터베이스 구조
대학의 수강신청을 예로 들어 3단계 데이터베이스 구조를 살펴보자.

대학의 수강신청 데이터베이스를 구축하기 위해서는 학생, 등록, 강의실, 교수, 강좌, 과목에 관한 테이블이 필요하다.
이 테이블들을 그림으로 나타내면 아래와 같다.

#### [수강신청 데이터베이스의 개념 스키마]
<img src="https://github.com/silxbro/cs-study/assets/142463332/66ed89ad-35f3-45ca-92d1-fa6df8d831f8" width="400" height="300"/><br/>
- 수강신청 데이터베이스의 전체 테이블 즉 **개념 스키마**에 해당한다.
  학생 테이블 상자를 보면 (학번, 이름, 주소, 학년)으로 구성되어 있고, 학번이 데이터를 구분하는 키(key)로 상자 윗부분에 따로 위치해 있는 모습이다.
  또 학생과 등록 사이의 점선은 학생이 등록을 하는 관계(relationship)를 갖고 있다는 의미다.
- 데이터베이스 구조를 설명하는 그림으로 **ER 다이어그램**이라고 부른다. 보통 상자 한 개가 테이블 한 개와 같다.

대학 내 학사관리과에서 수강등록 업무를 한다고 가정해보자. 학사관리과는 수강등록에 필요한 학생, 등록, 강좌, 과목에 관한 테이블만 필요로 한다.
즉 개념 스키마의 부분 스키마인 아래의 외부 스키마 1(학사 스키마)만 필요로 한다.

#### [수강등록 담당 부서에서 필요한 데이터베이스] (외부 스키마 1)
<img src="https://github.com/silxbro/cs-study/assets/142463332/3f631f6b-dbc2-40c1-9be9-757d8cdf80bf" width="400" height="250"/><br/>

시간표 작성을 담당하는 수업관리과에서는 시간표 작성에 필요한 교수, 강좌, 강의실, 과목에 관한 테이블만 필요로 한다.
마찬가지로 개념 스키마의 부분 스키마인 아래의 외부 스키마 2(수업 스키마)만 필요로 한다.

#### [시간표 담당 부서에서 필요한 데이터베이스] (외부 스키마 2)
<img src="https://github.com/silxbro/cs-study/assets/142463332/95864ce5-bcba-4cfc-adbb-69b6379355f0" width="400" height="270"/><br/>

내부 스키마는 개념 스키마가 실제로 하드디크스에 저장되는 물리적인 저장 구조에 관한 것으로 각 테이블을 어떤 방식으로 저장하느냐에 따라 여러 가지 방법이 있다.
다음 그림은 수강신청 데이터베이스의 내부 스키마를 그림으로 나타낸 것이다. 물리적인 저장 구조는 여기에 표현되어 있지 않다.

#### [수강신청 데이터베이스의 내부 스키마]
<img src="https://github.com/silxbro/cs-study/assets/142463332/70b06cb7-018c-4b7e-a7d3-b400f2d74e96" width="450" height="300"/><br/>

### 데이터 독립성
3단계 데이터베이스 구조의 특징은 데이터 독립성(data independence)이다.
데이터 독립성은 **하위 단계의 내용을 추상화**하여 상위 단계에 그 세부 사항을 숨김으로써 **한 단계 내의 변경에 대해서 다른 단계와 상호 간섭이 없도록 하는 것**이다.
일반 사용자는 사용자별로 외부 스키마가 있고, DBA는 일반 사용자의 외부 스키마에 영향을 주지 않고 개념 스키마나 내부 스키마의 물리적인 저장 방법을 바꿀 수 있다.
데이터 독립성에는 두 가지가 있다.

#### 🔳 논리적 데이터 독립성 (logical data independence)
외부 단계와 개념 단계 사이의 독립성으로, 개념 스키마가 변경되어도 외부 스키마에는 영향을 미치지 않도록 지원한다.
논리적 구조가 변경되어도 응용 프로그램에는 영향이 없도록 하는 개념이다.
예를 들어 개념 스키마의 테이블을 생성하거나 변경하여도 외부 스키마가 직접 다루는 테이블이 아니면 영향이 없다.
#### 🔳 물리적 데이터 독립성 (physical data independence)
개념 단계와 내부 단계 사이의 독립성으로, 저장장치 구조 변경과 같이 내부 스키마가 변경되어도 개념 스키마에 영향을 미치지 않도록 지원한다.
예를 들어 성능 개선을 위하여 물리적 저장장치를 재구성할 경우 개념 스키마나 응용 프로그램 같은 외부 스키마에 영향이 없다. 물리적 독립성은 논리적 독립성보다 구현하기 쉽다.