# 정규화 연습 (부동산 데이터베이스)
<br/>

부동산 정보를 저장하는 부동산 데이터베이스를 예로 들어 정규화를 연습해보자. 부동산 데이터베이스는 초기에 설계할 때 부동산에 대한 정보를 하나의 릴레이션으로 담았다.
- 부동산(필지번호, 주소, 공시지가, 소유자이름, 주민등록번호, 전화번호)

부동산 릴레이션에 포함된 함수 종속성은 아래와 같고, 이를 함수 종속성 다이어그램으로 나타내었다.

#### [부동산 릴레이션의 함수 종속성]
|함수 종속성|설명|
|:---|:---|
|필지번호 → 주소, 공시지가|땅에 대한 고유의 번호이며 필지에 대하여 주소의 공시가격이 주어진다.|
|소유자이름 → 전화번호|소유자는 하나의 전화번호를 갖는다.|
|주민등록번호 → 소유자이름|사람마다 고유한 주민등록번호가 있다.|

#### [부동산 릴레이션의 함수 종속성 다이어그램]
<img src="https://github.com/silxbro/cs-study/assets/142463332/60d9004a-cdb4-445b-ae82-c029b2fa9693" width="230" height="160"/><br/>

부동산 릴레이션은 다음의 두 가지 사례를 생각해볼 수 있다. 두 사례에 대하여 함수 종속성 다이어그램을 그리면 아래와 같다.
- 공동 소유 : 한 필지를 두 사람 이상이 공동으로 소유하는 경우
- 단독 소유 : 한 필지를 한 사람만 소유하는 경우

두 경우 모두 기본키를 정하는 것이 정규화의 첫 단계이다.
공동 소유는 필지를 두 사람이 소유할 수 있으므로 필자번호 단독으로는 키가 되지 못하고 (필지번호, 주민등록번호)가 기본키가 된다.
단독 소유의 경우는 필지번호가 기본키가 된다.

#### [두 사례에 대한 함수 종속성 다이어그램]
<img src="https://github.com/silxbro/cs-study/assets/142463332/462894d7-6395-438d-bc0f-b98a83153285" width="525" height="195"/><br/>

각 사례에 대하여 이상현상이 없는지 검토해보고, 있다면 정규화를 통해 해결해보자.

#### 🔳 공동 소유
공동 소유 릴레이션은 이상현상이 발생한다. 기본키인 필지번호와 주민등록번호를 보면 각각 단독으로 다른 속성을 결정하는 결정자이다.
즉 부분 함수 종속성을 가져 제 2정규형의 정의에 위배된다.
제 2정규형을 만족하려면 부분 함수 종속성을 없애야 하므로 부동산필지(필지번호, 주소, 공시지가)를 따로 분해하고, 소유자(주민등록번호, 소유자이름, 전화번호)도 따로 분해해야 한다.
결과적으로 공동 소유 릴레이션은 다음과 같이 분해된다.
- 부동산소유(필지번호, 주민등록번호)
- 부동산필지(필지번호, 주소, 공시지가)
- 소유자(주민등록번호, 소유자이름, 전화번호)

#### 🔳 단독 소유
단독 소유 릴레이션의 경우 기본키는 필지번호인데, 이상현상이 발생한다.
모든 속성이 기본키에 완전 함수 종속이므로 제 2정규형은 만족하지만 이행 종속이 남아있어서 제 3정규형은 만족하지 못하기 때문이다. 따라서 다음과 같이 분해하여 정규화한다.
- 부동산소유(필지번호, 주소, 공시지가, 주민등록번호)
- 소유자(주민등록번호, 소유자이름, 전화번호)
    - 소유자 릴레이션은 제 3정규형을 만족하지 못하므로 분해해야 한다.
      하지만 소유자 이름이 변경되거나 소유자가 여러 개의 전화번호를 등록할 필요가 없기 때문에 데이터 조작에 따른 이상현상이 발생할 가능성은 거의 없다.
      따라서 실무 응용에서는 그대로 둔다.